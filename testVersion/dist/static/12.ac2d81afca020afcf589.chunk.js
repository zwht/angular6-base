webpackJsonp([12],{392:function(e,t,a){"use strict";function n(e){o||a(798)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(502),i=a(799),o=!1,s=a(141),l=n,c=s(r.a,i.a,!1,l,"data-v-878c55fe",null);c.options.__file="src/views/admin/material.vue",t.default=c.exports},502:function(e,t,a){"use strict";var n=a(142),r=a(96),i=a.n(r);t.a={data:function(){var e=this;return{uploadUrl:n.a.uploadUrl,uploadHeader:{Authorization:i.a.get("authorization")},newItem:!1,searchState:-1,searchType:-1,userName:"",total:100,pageSize:1,pageCount:12,fileTypes:[],modelError:"",newItemForm:{type:101,dataUrl:"",name:"",languageType:"201"},tableHead:[{title:"ID",align:"center",width:150,key:"id"},{title:"资料名称",align:"center",width:220,key:"name"},{title:"类别",align:"center",width:100,key:"type",render:function(t,a){return t("span",e.getType(a.row.type))}},{title:"语言",align:"center",width:100,key:"type",render:function(e,t){return e("span",201==t.row.languageType?"中文":"英文")}},{title:"下载数",width:80,align:"center",key:"downloadNum"},{title:"操作用户",align:"center",width:100,key:"createUser"},{title:"上线时间",align:"center",key:"onLineTime",render:function(t,a){return a.row.onLineTime?t("span",e.timeFilter(a.row.onLineTime)):t("span","---")}},{title:"下线时间",align:"center",key:"downLineTime",render:function(t,a){return a.row.downLineTime?t("span",e.timeFilter(a.row.downLineTime)):t("span","---")}},{title:"状态",align:"center",width:80,key:"state",render:function(e,t){return"0"==t.row.state?e("span","已下线"):e("span","已上线")}},{title:"操作",align:"center",width:150,render:function(t,a){return"0"==a.row.state?t("div",[t("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"10px"},on:{click:function(){e.upline(a.row)}}},"上线"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteItem(a.row)}}},"删除")]):"1"==a.row.state?t("div",[t("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"10px"},on:{click:function(){e.downline(a.row)}}},"下线")]):void 0}}],tableData:[]}},created:function(){this.init()},methods:{timeFilter:function(e,t){if(void 0==e)return"";if(""==e)return"";t||(t="yyyy-MM-dd hh:mm:ss"),e.getFullYear||(e=new Date(e)),/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in a)if(new RegExp("("+n+")").test(t)){var r=a[n]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?r:function(e){return("00"+e).substr(e.length)}(r))}return t},getType:function(e){var t=!0,a=!1,n=void 0;try{for(var r,i=this.fileTypes[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;if(o.id==e)return o.value}}catch(e){a=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(a)throw n}}},deleteItem:function(e){var t=this;this.$Modal.confirm({title:"确定删除本条？",content:"删除后不可恢复",onOk:function(){n.a.ajax.get("/v1/data/delete?id="+e.id).then(function(e){t.$Notice.success({title:"删除成功"}),t.search()}).catch(function(e){})}})},uploadCall:function(e,t){0==e.errorCode?(this.modelError="",this.$Message.success("上传成功！"),this.newItemForm.dataUrl=e.data[0],this.newItemForm.name=t.name):(this.$Message.error("上传过程出错，请重新上传"),this.modelError=e.msg)},newSubmit:function(e){var t=this,a=JSON.parse(JSON.stringify(this.newItemForm));if(this.newItemForm.name||(this.$Message.error("请上传pdf文件！"),retuen),a.name.length>40)return void this.$Message.error("文件名太长，请修改！");a.languageType=parseInt(a.languageType),n.a.ajax.post("/v1/data/add/",a).then(function(e){var a=e.data,n=a.errorCode;a.data;0!==n||t.init(),t.loading=!1}).catch(function(e){t.loading=!1})},downline:function(e){var t=this;n.a.ajax.post("/v1/data/update",{id:e.id,state:0}).then(function(e){var a=e.data,n=a.errorCode;a.data;0!==n||t.init()}).catch(function(e){})},upline:function(e){var t=this;n.a.ajax.post("/v1/data/update",{id:e.id,state:1}).then(function(e){var a=e.data,n=a.errorCode;a.data;0!==n||t.init()}).catch(function(e){})},uploadError:function(e){this.$Notice.error({title:"上传失败",desc:e})},newItemShow:function(){this.newItem=!0},search:function(){var e=this,t={};-1!=this.searchState&&(t.state=this.searchState),-1!=this.searchType&&(t.type=this.searchType),n.a.ajax.post("/v1/data/list/"+this.pageSize+"/"+this.pageCount,t).then(function(t){var a=t.data,n=a.errorCode,r=a.data;0!==n||(e.total=r.totalCount,e.tableData=r.pageData),e.loading=!1}).catch(function(t){e.loading=!1})},init:function(){var e=this;n.a.ajax.post("/v1/dict/all",{}).then(function(t){var a=t.data,n=a.errorCode,r=a.data;if(0!==n);else{var i=[];r.forEach(function(e){"中文"!==e.value&&"英文"!==e.value&&i.push(e)}),e.fileTypes=i}e.loading=!1}).catch(function(t){e.loading=!1}),this.search()},pageChange:function(e){this.pageSize=e,this.search()}}}},798:function(e,t){},799:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"material"},[a("div",{staticClass:"top-box"},[a("Select",{staticStyle:{width:"200px"},on:{"on-change":e.search},model:{value:e.searchState,callback:function(t){e.searchState=t},expression:"searchState"}},[a("Option",{attrs:{value:-1}},[e._v("全部状态")]),e._v(" "),a("Option",{attrs:{value:1}},[e._v("已上线")]),e._v(" "),a("Option",{attrs:{value:0}},[e._v("已下线")])],1),e._v(" "),a("Select",{staticStyle:{width:"200px"},on:{"on-change":e.search},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[a("Option",{attrs:{value:-1}},[e._v("全部类别")]),e._v(" "),e._l(e.fileTypes,function(t,n){return a("Option",{key:n,attrs:{value:t.id}},[e._v(e._s(t.value))])})],2),e._v(" "),a("Button",{staticClass:"fr",attrs:{size:"default",type:"info"},on:{click:e.newItemShow}},[e._v("新增资料")])],1),e._v(" "),a("Table",{attrs:{columns:e.tableHead,data:e.tableData}}),e._v(" "),a("Page",{staticStyle:{"margin-top":"15px"},attrs:{total:e.total,current:e.pageSize,"page-size":12},on:{"on-change":e.pageChange}}),e._v(" "),a("Modal",{attrs:{title:"上传资料"},on:{"on-ok":e.newSubmit,"on-cancel":function(t){e.newItem=!1}},model:{value:e.newItem,callback:function(t){e.newItem=t},expression:"newItem"}},[a("Form",{ref:"newItemForm",attrs:{model:e.newItemForm,"label-width":80}},[a("FormItem",{attrs:{label:"文件类别"}},[a("Select",{staticStyle:{width:"200px"},model:{value:e.newItemForm.type,callback:function(t){e.$set(e.newItemForm,"type",t)},expression:"newItemForm.type"}},e._l(e.fileTypes,function(t,n){return a("Option",{key:n,attrs:{value:t.id}},[e._v(e._s(t.value))])}))],1),e._v(" "),a("FormItem",{attrs:{label:"文件名"}},[a("span",{domProps:{textContent:e._s(e.newItemForm.name)}})]),e._v(" "),a("FormItem",{attrs:{label:"上传文件"}},[a("Upload",{attrs:{action:e.uploadUrl,format:["pdf"],"on-success":e.uploadCall,"show-upload-list":!1,"on-error":e.uploadError,headers:e.uploadHeader}},[a("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[e._v("选择文件")])],1)],1),e._v(" "),a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"语言"}},[a("RadioGroup",{model:{value:e.newItemForm.languageType,callback:function(t){e.$set(e.newItemForm,"languageType",t)},expression:"newItemForm.languageType"}},[a("Radio",{attrs:{label:"201"}},[e._v("中文")]),e._v(" "),a("Radio",{attrs:{label:"202"}},[e._v("英文")])],1)],1),e._v(" "),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.modelError,expression:"modelError"}],attrs:{label:"错误信息"}},[a("span",{staticStyle:{color:"red"}},[e._v(e._s(e.modelError))])])],1)],1)],1)},r=[];n._withStripped=!0;var i={render:n,staticRenderFns:r};t.a=i}});