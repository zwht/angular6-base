webpackJsonp([11],{389:function(t,e,n){"use strict";function i(t){r||n(788)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(498),o=n(789),r=!1,s=n(141),c=i,l=s(a.a,o.a,!1,c,"data-v-1a1df5ad",null);l.options.__file="src/views/admin/news.vue",e.default=l.exports},498:function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=n(142),o=n(96);n.n(o);e.a={data:function(){var t=this;return{searchStatus:-1,userName:"",total:100,pageSize:1,pageCount:12,fileTypes:[],tableHead:[{title:"ID",align:"center",key:"id"},{title:"标题",width:200,align:"left",key:"title",render:function(t,e){return e.row.stick?t("div",[t("span",{style:{color:"#fff",backgroundColor:"red",fontSize:"12px",lineHeight:"16px",display:"inline-block",borderRadius:"3px",marginRight:"6px",padding:"1px 4px",verticalAlign:"top"}},"置顶"),t("span",e.row.title)]):t("span",e.row.title)}},{title:"摘要",width:220,align:"center",key:"summary"},{title:"语言",align:"center",width:80,key:"type",render:function(t,e){return t("span",201==e.row.languageType?"中文":"英文")}},{title:"链接",width:80,align:"center",render:function(e,n){return"1"==n.row.state?e("a",{on:{click:function(){t.godetail(n.row)}}},"访问"):e("span","--")}},{title:"发布时间",align:"center",render:function(e,n){return n.row.onLineTime?e("span",t.timeFilter(n.row.onLineTime)):e("span","---")}},{title:"状态",align:"center",width:80,key:"state",render:function(t,e){return"0"==e.row.state?t("span","已下线"):t("span","已发布")}},{title:"发布用户",align:"center",width:90,key:"state",render:function(t,e){return"0"==e.row.state?t("span","---"):t("span",e.row.updateUser)}},{title:"操作",align:"center",width:180,render:function(e,n){return e("div",["1"==n.row.state?"":e("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"10px"},on:{click:function(){t.editNews(n.row)}}},"编辑"),"1"==n.row.state?e("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"10px"},on:{click:function(){t.downline(n.row)}}},"下线"):e("Button",{props:i({type:"ghost",size:"small"},"type","info"),style:{marginRight:"10px"},on:{click:function(){t.upline(n.row)}}},"发布"),"1"==n.row.state?0==n.row.stick?e("Button",{props:i({type:"ghost",size:"small"},"type","success"),style:{},on:{click:function(){t.stickTop(n.row)}}},"置顶"):e("Button",{props:i({type:"ghost",size:"small"},"type","ghost"),style:{},on:{click:function(){t.cancleStickTop(n.row)}}},"取消置顶"):"","0"==n.row.state?e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.deleteItem(n.row)}}},"删除"):""])}}],tableData:[]}},created:function(){this.init()},methods:{timeFilter:function(t,e){if(void 0==t)return"";if(""==t)return"";e||(e="yyyy-MM-dd hh:mm:ss"),t.getFullYear||(t=new Date(t)),/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var i in n)if(new RegExp("("+i+")").test(e)){var a=n[i]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?a:function(t){return("00"+t).substr(t.length)}(a))}return e},deleteItem:function(t){var e=this;this.$Modal.confirm({title:"确定删除本条？",content:"删除后不可恢复",onOk:function(){a.a.ajax.get("/v1/news/delete?id="+t.id).then(function(t){e.$Notice.success({title:"删除成功"}),e.search()}).catch(function(t){})}})},preview:function(t){this.$router.push({path:"/admin/news/preview/"+t.id})},godetail:function(t){console.log(location);var e=location.origin+"/",n="#/news/"+t.id;window.open(e+n)},editNews:function(t){this.$router.push({path:"/admin/news/editnews/"+t.id})},addNews:function(){this.$router.push({path:"/admin/news/editnews/0"})},downline:function(t){var e=this;a.a.ajax.post("/v1/news/update",{id:t.id,state:0}).then(function(t){var n=t.data,i=n.errorCode;n.data;0!==i||e.init()}).catch(function(t){})},cancleStickTop:function(t){var e=this;a.a.ajax.post("/v1/news/update",{id:t.id,stick:0}).then(function(t){var n=t.data,i=n.errorCode;n.data;0!==i||e.init()}).catch(function(t){})},stickTop:function(t){var e=this;a.a.ajax.post("/v1/news/update",{id:t.id,stick:1}).then(function(t){var n=t.data,i=n.errorCode;n.data;0!==i||e.init()}).catch(function(t){})},search:function(){var t=this,e={};-1!=this.searchStatus&&(e.state=this.searchStatus),a.a.ajax.post("/v1/news/list/"+this.pageSize+"/"+this.pageCount,e).then(function(e){var n=e.data,i=n.errorCode,a=n.data;0!==i||(t.total=a.totalCount,t.tableData=a.pageData),t.loading=!1}).catch(function(e){t.loading=!1})},upline:function(t){var e=this;a.a.ajax.post("/v1/news/update",{id:t.id,state:1}).then(function(t){var n=t.data,i=n.errorCode;n.data;0!==i||e.init()}).catch(function(t){})},init:function(){this.search()},pageChange:function(t){this.pageSize=t,this.search()}}}},788:function(t,e){},789:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"news"},[n("div",{staticClass:"top-box"},[n("Select",{staticStyle:{width:"200px"},on:{"on-change":t.search},model:{value:t.searchStatus,callback:function(e){t.searchStatus=e},expression:"searchStatus"}},[n("Option",{attrs:{value:-1}},[t._v("全部状态")]),t._v(" "),n("Option",{attrs:{value:1}},[t._v("已上线")]),t._v(" "),n("Option",{attrs:{value:0}},[t._v("已下线")])],1),t._v(" "),n("Button",{staticClass:"fr",attrs:{size:"default",type:"info"},on:{click:t.addNews}},[t._v("添加新闻")])],1),t._v(" "),n("Table",{attrs:{columns:t.tableHead,data:t.tableData}}),t._v(" "),n("Page",{staticStyle:{"margin-top":"15px"},attrs:{total:t.total,current:t.pageSize,"page-size":12},on:{"on-change":t.pageChange}})],1)},a=[];i._withStripped=!0;var o={render:i,staticRenderFns:a};e.a=o}});